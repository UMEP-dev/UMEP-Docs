



Post-Processor
--------------

Solar Radiation: SEBE (Visualisation)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* Contributor:
  ::
     Niklas Krave (Gothenburg)

* Introduction:
     - The **SEBE (Visualisation)** plugin can be used to visulise 3D output from model results generated by the SEBE plugin.

* Location:
    - The Shadow Generator is located at
        -  UMEP
          -  Post-Processor
            -  Solar Radiation
              -  SEBE (Visualisation)

* Dialog box  :
      .. figure:: /images/SEBEvisualisation.png

* Dialog sections  :
+----------+----------------------------+
| top      | Canvas for visualisation   |
+----------+----------------------------+
| bottom   | Input data and settings    |
+----------+----------------------------+

* Select input folder:
     -  The directory where results from a previous model run in SEBE is located.

* Area of visualisation:
     -  When this pushbutton is clicked, a recanglge can be drawn on the map canvas. This is the area that will be visulised.

* Visulise:
     - When this button is clicked, the selected rectangular area will be visulised in the SEBE (visualisation) canvas at the top of the GUI.

* Close:
     -  This closes the plugin.


Outdoor Thermal Comfort: SOLWEIG Analyzer
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* Contributor:
  ::
     Fredrik Lindberg (Gothenburg)

* Introduction:
     - The **SOLWEIG Analyzer** plugin can be used to make basic analysis of model results generated by the SOLWEIG plugin.

* Location:
    - The SOLWEIG Analyzer is located at
        -  UMEP
          -  Post-Processor
            -  Outdoor Thermal Comfort
              -  SOLWEIG Analyzer

* Dialog box  :
      .. figure:: /IMAGES/SOLWEIGAnalyzer.png

* Dialog sections  :
+----------+------------------------------------------------------------------------------------------------+
| top      | Input data is specified                                                                        |
+----------+------------------------------------------------------------------------------------------------+
| left     | Plotting of time series derived from Points of Interest during model calculations in SOLWEIG   |
+----------+------------------------------------------------------------------------------------------------+
| bottom   | Analysis of spatial results from model calculations in SOLWEIG                                 |
+----------+------------------------------------------------------------------------------------------------+

* Load model result:
     - The directory where results from a previous model run in SOLWEIG is located.

* Point of Interest data:
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
| POIs available               | Here, a list of all available POI files are listed. Specify one of the POIs. If no variable is available, then no data if found in the Model output folder.   |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Variable                     | Specify one of the available variables to plot.                                                                                                               |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Add another POI / variable   | Tick this in to add another variable in the plot.                                                                                                             |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Scatterplot                  | Tick this in to generate a scatterplot between the two variables specified above.                                                                             |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Plot                         | Plot the data selected above                                                                                                                                  |
+------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+

* Spatial data  :
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Variable to visualize                                   | Select a listed variable to process. If no variable is available, then no data if found in the Model output folder.                                                                                                       |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Show animation                                          | This produces a time-related animation of the selected variable scaled based on the settings to the left in the GUI.                                                                                                      |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Exclude building pixels                                 | Tick this in to exclude building pixels using a building grid generated from the SOLWEIG run. The building grid must have the same extent and pixel resolution as the generated output maps in the model output folder.   |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Diurnal average                                         | Tick this in to include all grids for the selected variable to derive a pixelwise average.                                                                                                                                |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Daytime average                                         | Tick this in to include all daytime grids for the selected variable to derive a pixelwise average.                                                                                                                        |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Nightime average                                        | Tick this in to include all nighttime grids for the selected variable to derive a pixelwise average.                                                                                                                      |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Maximum                                                 | Tick this in to get the pixelwise maximum for the selected variable.                                                                                                                                                      |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Minimum                                                 | Tick this in to get the pixelwise minimum for the selected variable.                                                                                                                                                      |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Average of specific time of day                         | The average of the selected time of day for the variable selected is generated. If 'Not Specified' is highlighted, no grid will be generated.                                                                             |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Maximum of specific time of day                         | The maximum of the selected time of day for the variable selected is generated. If 'Not Specified' is highlighted, no grid will be generated.                                                                             |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Minimum of specific time of day                         | The minimum of the selected time of day for the variable selected is generated. If 'Not Specified' is highlighted, no grid will be generated.                                                                             |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| T\ :sub:`mrt`: Percent of time above threshold (degC)   | If T\ :sub:`mrt` is the selected variable, this box become active and calculates the percent of time that T\ :sub:`mrt` for each is above the threshold specified to the right.                                           |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| T\ :sub:`mrt`: Percent of time below threshold (degC)   | If T\ :sub:`mrt` is the selected variable, this box become active and calculates the percent of time that T\ :sub:`mrt` for each is below the threshold specified to the right.                                           |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Output folder                                           | Directory where the results specified above will be saved.                                                                                                                                                                |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Add analysis to map canvas                              | All analysis specified above will be added to the map canvas if this box is ticked in.                                                                                                                                    |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Generate                                                | Starts the spatial processing/analysis.                                                                                                                                                                                   |
+---------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

* Close:
     - This closes the plugin.


Urban Energy Balance: SUEWS Analyser
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* Contributor:
  ::
     Fredrik Lindberg (Gothenburg)

* Introduction:
     - The **SUEWS Analyzer** plugin can be used to make basic analysis of model results generated by the *SUEWS Simple* and *SUEWS Advanced* plugins.

* Location:
    -  The SUEWS Analyzer is located at
        -  UMEP
          -  Post-Processor
            -   Urban Energy Balance
              -  SUEWS Analyzer

* Dialog box  :
      .. figure:: /images/SUEWSAnalyzer.png

* Dialog sections  :
+----------+----------------------------------------------------------------------------------------------+
| top      | Model results to be analyzer is specified.                                                   |
+----------+----------------------------------------------------------------------------------------------+
| left     | Plotting of time series derived from Points of Interest during model calculations in SUEWS   |
+----------+----------------------------------------------------------------------------------------------+
| bottom   | Analysis of spatial results from model calculations in SUEWS                                 |
+----------+----------------------------------------------------------------------------------------------+

Load model result:
     -  A namelist (*RunControl.nml*) used for the model run should be specified. This can be located in the **suewsmodel** directory found as a sub-directory of the **UMEP**-plugin directory. Note that the namelist includes information on the last model run performed.

* Point data:
+----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Grid                       | Here, a list of all available modeled grids are listed. Specify one of the grid IDs. If no grid is available, then no data if found in the model output folder.   |
+----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Year to investigate        | Specify one of the available years to plot.                                                                                                                       |
+----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Plot basic data            | Tick this in to plot a summary of the most essential output variables.                                                                                            |
+----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Time Period (DOY)          | Specify the time period to plot.                                                                                                                                  |
+----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Variable                   | Specify one of the available variables to plot.                                                                                                                   |
+----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Include another variable   | Tick this in to add another variable in the plot.                                                                                                                 |
+----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Grid                       | Here, a list of all available modeled grids are listed. Specify one of the grid IDs. If no grid is available, then no data if found in the model output folder.   |
+----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Variable                   | Specify one of the available variables to plot.                                                                                                                   |
+----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Scatterplot                | Tick this in to generate a scatterplot between the two variables specified above.                                                                                 |
+----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Plot                       | Plot the data selected above                                                                                                                                      |
+----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Spatial data:

+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Variable to analyze                           | Select a listed variable to process. If no variable is available, then no data if found in the Model output folder.   |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Year to investigate                           | Specify one of the available years to plot.                                                                           |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Time Period (DOY)                             | Specify the time period to plot.                                                                                      |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Average                                       | Tick this in to derive a grid-wise average.                                                                           |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Maximum                                       | Tick this in to derive a grid-wise maximum.                                                                           |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Minimum                                       | Tick this in to derive a grid-wise minimum.                                                                           |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Median                                        | Tick this in to derive a grid-wise median value.                                                                      |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| IQR                                           | Tick this in to derive a grid-wise interquartile range.                                                               |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Diurnal                                       | Tick this in to include diurnal (all) data.                                                                           |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Daytime                                       | Tick this in to include daytime data.                                                                                 |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Nightime                                      | Tick this in to include nighttime data.                                                                               |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Vector polygon grid used in the SUEWS model   | Specify the grid that was used to generate the input data to the SUEWS model run of interest.                         |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| ID                                            | Specify the attribute ID used to generate the input data to the SUEWS model run of interest.                          |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Add result to polygon grid                    | Tick this box to add the results in the attribute table of the grid specified.                                        |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Save of GeoTIFF                               | Tick this in to generate a raster grid from the analyze settings specified.                                           |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Irregular grid (not squared)                  | Tick this in if a grid is irregular i.e. not squared and aligned north to south.                                      |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Pixel resolution (m)                          | When a irregular grid is used, a pixel resolution in meters must be specified.                                        |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Output filename                               | Name of the GeoTIFF to be saved.                                                                                      |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Add analysis to map canvas                    | All analysis specified above will be added to the map canvas if this box is ticked in.                                |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+
| Generate                                      | Starts the spatial processing/analysis.                                                                               |
+-----------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+

* Close:
     -  This closes the plugin.


Benchmark System
~~~~~~~~~~~~~~~~
* Contributor:
  ::
     Ting Sun (Reading), Sue Grimmond

*  Overview :
     -  **Note**: the current version runs in a command-line interface (CLI) driven by Python and the GUI-based version is under construction.
     -  The Benchmark System for SUEWS (BSS) can be used with SUEWS to assess the model performance between different configurations and model generations. BSS is written in Python and shipped with an example namelist and an MS Excel spreadsheet for header lookup between different SUEWS versions.

* Location:
    -  The SUEWS Analyzer is located at
        -  UMEP
          -  Post-Processor
            -   Benchmark

* Benchmark results:
    -  Two types of metrics are provided: :
          -  overall performance score: a score between 0 and 100 with larger score denoting better overall performance
          -  specific statistics: a range of statistics, including Mean absolute error (MAE), root mean square error (RMSE), standard deviation (Std), etc., to indicate detailed performance in specific variables.
    -  The users can use the overall performance score to get the performance overview of all configurations (Fig. 1a) and specific statistics to examine the performance details (Fig. 1b).
        .. figure:: /images/300px-BSS-result.png
        Figure 1: BSS results for (a) the overall performance and (b) a specific statistics (e.g., RMSE)

* Usage:
    -  To use BSS, in addition to the mandatory BSS files (i.e., Benchmark\_SUEWS.py, benchmark.nml and head-2016to2017.xlsx), the SUEWS output results are required to be placed in a separate folder (e.g., “input”) that contains the sub-folders of results produced by different configurations. A sample layout of the BSS test case refers to Fig. 2. It must be noted that the output files to be benchmarked should be of consistent temporal organisation (i.e., identical length and resolution) while the headers of different files are not necessarily to be identical as BSS will handle the header inconsistency automatically. Besides, two sub-folders, “base” and “ref”, which contain the baseline results to be tested against and reference results to be compared with, respectively, must exist otherwise the BSS will stop.   |
    -   When the SUEWS output files are prepared, the namelist (i.e., benchmark.nml) needs to be set for the benchmarking. The benchmark namelist is fairly self-explanatory and consists two sections, “file” and “benchmark”, to play with. One tip is about the variable list (i.e., var\_list): if one non-string value is set (e.g., 123, 3.2, etc.), all valid variables will be included in the benchmarking. Then the user can execute the Benchmark\_SUEWS.py script and a PDF file with benchmark results will be generated (e.g., benchmark.pdf in Fig. 2).
          .. figure:: /images/300px-BSS-file-layout.png
          Figure 2: Required file organisation by BSS.
* Namelist: benchmark.nml:
     -  The benchmark namelist is fairly self-explanatory and consists two sections, “file” and “benchmark”, to play with.
     -  One tip is about the variable list (i.e., var\_list): if one non-string value is set (e.g., 123, 3.2, etc.), all valid variables will be included in the benchmarking.
     -  A sample namelist is as follows:
        ::
          &file
            input_dir = 'input'
            output_pdf = 'benchmark'
          /
          &benchmark
            list_var='QN' 'QS' 'QE' 'QH'
            list_metric='MAE' 'MBE' 'RMSE'
            method_score=1 ! not used yet
          /
